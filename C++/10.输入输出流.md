### C++的输入和输出

- 标准I/O：对系统指定的标准设备的输入和输出。即从键盘输入数据，输出到显示器屏幕。
- 文件I/O：以外存（磁盘、光盘）为对象进行输入和输出，例如从磁盘文件出入数据，数据输出到磁盘文件。
- 串I/O：对内存中指定的空间进行输入和输出。



#### C++的输入输出流

- `cout`和插入运算符“<<”向显示器输出数据时，先将这些数据插入到输出流（`cout` 流），送到程序中的输出缓冲区保存，直到缓冲区满了或遇到`endl`，就将缓冲区中的全部数据送到显示器显示出来。

-  在输入时，从键盘输入的数据先放在键盘的缓冲区中，当按回车键时，键盘缓冲区中的数据输入到程序的输入缓冲区，形参`cin` 流，然后用提取运算符“>>”从输入缓冲区中提取数据送给程序中的有关变量。



##### 与流类库有关的头文件

`iostream` 包含了对输入输出流进行操作所需要的基本信息；

`fstream` 用于用户管理的文件的I/O操作；



##### 在`iostream` 头文件中定义的流对象

- `cin` 标准输入流
- `cout` 标准输出流
- `cerr` 标准错误流
- `clog` 标准错误流



在`iostream` 头文件中重载运算符

“<<” 和“>>” 本来是C++定义为左位移运算符和右位移运算符的，由于在`iostream` 头文件中对它们进行了重载，使它们能用作标准类型数据的输入和输出运算符。





#### 标准输出流

##### `cout` ，`cerr` 和 `clog` 流

`cout` 是 console output的缩写，意为控制台（终端显示器）的输出。

- `cout` 不是C++预定义的关键字，它是ostream 流派生类的对象
- `cout` 流是容纳数据的载体，它并不是一个运算符
- `cout` 流在内存中对应开辟了一个缓冲区，用来存放流中的数据，当向`cout` 流插入一个`endl`  时，不论缓冲区是否已满，都立即输出流中所有数据，然后插入一个换行符，并刷新流（清空缓冲区）；



`cerr` 流是标准错误流，它是 console error 的缩写。` cerr` 与标准输出流`cout` 的作用和用法差不多。但有一点不同：`cout` 流通常是传送到显示器输出，但也可以被重定向输出到磁盘文件，而`cerr` 流中的信息只能在显示器输出。



`clog` 流对象也是标准错误流，它是 console log 的缩写，它的作用和`cerr` 相同，都是在终端显示器上显示出错信息。它们之间有一个微小的区别：`cerr` 是不经过缓冲区直接向显示器上输出有关信息，而`clog` 中的信息存放在缓冲区中，缓冲区满后或遇`endl` 时向显示器输出。





##### 标准类型数据的格式输出

......



##### 用流成员函数`put` 输出字符

`put` 是专用于输出单个字符的成员函数。

```c++
cout.put('a');
```







#### 标准输入流

##### `cin` 流

- `cin` 是`istream` 类的派生类的对象；
- 程序中的变量通过流提取符“>>” 从流中提取数据，流提取符“>>” 从流中提取数据时，通常跳过输入流中的空格、Tab键、换行符等空白字符；
- 只有在键盘输入完数据并按`Enter` 键后，该行数据才被送入键盘缓冲区，形成输入流，提取运算符“>>” 才能从中提取数据；
- 当输入流`cin` 处于出错状态时，它的值为false，即`cin` 为0值；如果输入流在正常状态，`cin` 的值为true，即`cin` 为一个非0值；



##### `get` 函数读入一个字符

流成员函数`get` 有3中形式：无参数的、有一个参数的、有3个参数的。

**① 无参数的`get` 函数**

- 用来从指定的输入流中提取一个字符（**包括空白字符**），函数的返回值是读入的字符；
- 若遇到输入流中的文件结束符，则函数的返回值为`EOF`； 
- `cin.get()` 和C语言中的`getchar` 函数功能相同；

```c++
cin.get();
//等价于
char c = getchar();	  //C语言中的函数
```



**② 有一个参数的`get` 函数**

```c++
/*从输入流中读取一个字符，赋值给字符变量ch。如果读取成功，则函数返回非0值，如失败（遇到文件结束符）则返回0值。
*/
cin.get(ch);
```



**③ 有3个参数的`get` 函数**

```c++
/*
从输入流中读取n-1（因为最后一个字符默认为\0）个字符，赋给指定的字符数组（或字符指针指向的数组），如果在读取n-1个字符之前遇到指定的终止字符，则提前结束读取
*/
cin.get(字符数组/字符指针，字符个数n，终止字符)；
```



##### `getline` 函数读入字符串

**`getline` 可以接收空格**

```c++
istream& getline(char* s, streamsize n);
istream& getline(char* s, streamsize n, char delim);

char c[20];
cin.getline(c, 15);
```

在`<string>` 文件中，对`getline` 函数重载

```c++
istream& getline(istream& input, string& str, char delim);
istream& getline(istream& input, string& str);

string s;
getline(cin, s);
```





#### 对数据文件的操作与文件流

##### 文件流类和文件流对象

- `ifstream` 类，是从`istream` 类派生的，用来支持从磁盘文件的输入；
- `ofstream` 类，是从`ostream` 类派生的，用来支持向磁盘文件的输出；
- `fstream` 类，是从`iostream` 类派生的，用来支持对磁盘文件的输入输出；

```c++
ofstream outfile;	//定义输出文件流对象
```



##### 文件的打开和关闭

① 打开磁盘文件

- 为文件流对象和指定的磁盘文件建立关联，以便使文件流流向指定的磁盘文件；
- 指定文件的工作方式，如，该文件是作为输入文件还是输出文件，是`ASCII` 文件还是二进制文件等；

```c++
// 文件流对象.open(磁盘文件名，输入输出方式);
//磁盘文件名可以包括路径，默认为当前目录下的文件

ofstream outfile;
outfile.open("f1.dat", ios::out);	//ios::out是I/O模式的一种，表示以输出的方式打开文件
```



常见的文件输入输出方式的值有：

|         方式          |                             作用                             |
| :-------------------: | :----------------------------------------------------------: |
|        ios::in        |                     以输入的方式打开文件                     |
|       ios::out        | 以输出方式打开文件，如果已有此名字的文件，则将其原有内容全部清除（默认） |
|       ios::app        |         以输出方式打开文件，写入的数据添加在文件末尾         |
|       ios::ate        |           打开一个已有的文件，文件指针指向文件末尾           |
|      ios::trunc       | 打开一个文件，如果文件已存在，则删除其中全部内容，如文件不存在，则建立新文件。如已指定ios::out 方式，而未指定ios::app, ios::ate, ios::in，则同时默认此方式 |
|      ios::binary      | 以二进制方式打开一个文件，如不指定此方式则默认为`ASCII` 方式 |
|     ios::nocreate     |          打开一个已有文件，如文件不存在，则打开失败          |
|    ios::noreplace     |     如果文件不存在则建立新文件，如果文件已存在则操作失败     |
|   ios::in\|ios::out   |            以输入和输出方式打开文件，文件可读可写            |
| ios::out\|ios::binary |                 以二进制方式打开一个输出文件                 |
| ios::in\|ios::binary  |                 以二进制方式打开一个输入文件                 |

> 如果打开操作失败，open 函数返回值为0



##### 关闭磁盘文件

在对已打开的磁盘文件的读写操作完成后，应关闭该文件。

```c++
outfile.close();
```



```c++
#include<fstream>
using namespace std;

int main(){
	int a[10];
	ofstream outfile("f1.dat", ios::out);
	//ofstream outfile;
	//if(outfile.open("f1.dat", ios::app) == 0)
	if(!outfile){
		cerr << "open error!" << endl;
		exit(1);
	}
	cout << "enter 10 integer numbers:" << endl;
	for(int i=0; i<10; i++){
		cin >> a[i];
		outfile << a[i] << " ";
	}
	outfile.close();
	
	return 0;
}
```





#### 对二进制文件的操作

用成员函数`read` 和`write` 读写二进制文件

```c++
istream& read(char* buffer, int len);
ostream& write(const char* buffer, int len);
```

